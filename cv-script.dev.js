/******************************************************************************************************************************** /* Cv-script.dev.js - 07/02/2011 - Arnaud Lefebvre - Using JQuery																*																/* 																																*/* This script allow you add JQuery effects on elements defining																*/* one or more configuration. 																									*			/* These configurations have to be set with 7 elements :																		*/* - cvTitleEltClass //Class of elements which is the title (not really used now but required)									*/* - cvInfosEltClass //Class of elements which contains more informations														*/* - cvMoreEltClass  //Class of elements on which a click show cvInfosEltClass													*		/* - cvLessEltClass  //Class of elements on which a click hide cvInfosEltClass													*/* - effect			 //Effect which be apply when displaying or hidding cvInfosEltClass											*	/* - time			 //Duration in millisecond of the effect when displaying cvInfosEltClass									*/* - hiddingTime (optionnal) //Duration in millisecond of the effect when hidding cvInfosEltClass								*/*																																*	/********************************************************************************************************************************/*/* Here is an example of how to use the script :/* /* <html>/* 	<head>/* 		<script src="js/jquery.js"></script>/* 	</head>/* 	<body>/* 		<table>/* 			<tr>	/* 				<td><div class="cvwhat">This a very good movie.</div></td>/* 				<td><span class="cvMoreEltClass">More infos ?</span>	/* 				<td><span class="cvLessEltClass">Less infos ?</span></td>/*			</tr> /* 			<tr>	/* 				<div class="cvInfosEltClass">/* 					This bloc contains more information/* 					about this very good movie.			/* 				</div>/* 			</tr>/* 		</table>/* 	</body>/* /* 	<script src="js/cv-script.test.js"></script>/* 	<script type="text/javascript">/* /* 	//create a CvScript object./* 	var cvScript = new CvScript();/* /* 	//create a configuration object/* 	var config0 = new Configuration();/* 	//Set the class of the four elements/* 	config0.cvTitleEltClass = ".cvwhat";/* 	config0.cvMoreEltClass = ".cvMoreEltClass";/* 	config0.cvLessEltClass = ".cvLessEltClass";/* 	config0.cvInfosEltClass = ".cvInfosEltClass";/* /* 	//Chose an effect. Must be Constants.EFFECTS.slide or Constants.EFFECTS.fade or Constants.EFFECTS.toggle/* 	config0.effect = Constants.EFFECTS.slide;/*/* 	//Set the time of the displaying effect/* 	config0.time = "2000";/*/* 	//Set the time of the hidding effect (optionnal)/* 	config0.hiddingTime = "850";/*/* 	//You could create other configuration Object setting different values to attributes/* 	//var config1 = new Configuration();/* 	// .../* 	//var configN = new Configuration();/* /* 	//Add the configuration(s) to cvScript /* 	cvScript.addConfiguration(config0);/* 	/*  //Eventually/* 	//cvScript.addConfiguration(config1);/* 	// .../* 	//cvScript.addConfiguration(configN);/* /* /* 	//add Events and effects to elements defines by cvScript's configurations/* 	cvScript.addEffects();/* /* </script>/* </html>/****************************************************************************************************/$(document).ready(function(){            // Creation de la classe de Constantes            function Constants() {                this.Constants = Constants.EFFECTS.none;            }            Constants.EFFECTS = {                none : -1,                slide : 0,                fade: 1,                toggle : 2,                hiddingTime : 300            }            Constants.ELEMENTS = {                title : "title",                more : "more",                less : "less",                infos : "infos",                clmore : "clmore",                cltitle : "cltitle",                clless : "clless",                clinfos : "clinfos"            }            Constants.GLOBAL = {                nbElementsMax : 100,                identifier : "_",                clend : "AZBYCX"            }            /**             * Classe configuration. représente une configuration du script.             * Une configuration définie quels sont les élements que le script doit prendre             * en compte ainsi que l'effet et sa durée qui lui seront appliqué.             *             * Ses paramètres sont les suivants :             *  cvTitleEltClass : class de des elements de titre. (Pas très important car aucun effet ne lui est appliqué)             *  cvMoreEltClass : class de des elements pour lequel un clic déclenchera l'apparition de l'element contenant les informations complémentaires             *  cvLessEltClass : class de des elements pour lequel un clic déclenchera la désapparition de l'element contenant les informations complémentaires             *  cvInfosEltClass : class des elements contenant les informations complémentaires             *  effect : type d'effet à appliquer. Doit etre un element de Constants.EFFECTS             *  time : durée en millisecondes de l'effet.             **/            function Configuration() {                this.cvTitleEltClass = "";                this.cvMoreEltClass = "";                this.cvLessEltClass = "";                this.cvInfosEltClass = "";                this.effect = Constants.EFFECTS.none;                this.time = Constants.EFFECTS.none;                this.hiddingTime = Constants.EFFECTS.hiddingTime;                if( typeof Configuration.initialized == "undefined" ) {                     //toString() function                    Configuration.prototype.toString = function() {                        return "Configuration : \ncvTitleEltClass = "+this.cvTitleEltClass+",\ncvMoreEltClass = "+this.cvMoreEltClass+",\ncvLessEltClass = "+this.cvLessEltClass+",\ncvInfosEltClass = "+this.cvInfosEltClass+",\neffect = "+this.effect+",\ncvtime = "+this.time;                    };                    Configuration.initialized = true;                }            }            function CvScript() {                this.configurations = Array();                this.nbConfigurations = 0;                if( typeof CvScript.initialized == "undefined" ) {                    //toString() function                    CvScript.prototype.toString = function() {                        var result =  "CvScript :\n";                        for (i=0;i<this.nbConfigurations;i++)                        {                            result += "Configuration N°"+(i+1)+"\n";                            result += this.configurations[i].toString();                            result += "\n";                        }                        result +="nbConfigurations = "+this.nbConfigurations;                        return result;                    };                    /** Function addConfiguration()                     * Ajoute une configuration au moteur du script.                     *                     * @param configuration Instance d'objet Configuration dont les valeurs sont settées !                     **/                    CvScript.prototype.addConfiguration = function(configuration) {                        if( typeof configuration == "object" ) {                            if (configuration.cvInfosEltClass != undefined && configuration.cvInfosEltClass != ""                            && configuration.cvLessEltClass != undefined && configuration.cvLessEltClass != ""                            && configuration.cvMoreEltClass != undefined && configuration.cvMoreEltClass != ""                            && configuration.cvTitleEltClass != undefined && configuration.cvTitleEltClass != ""                            && configuration.effect != undefined && configuration.effect != Constants.EFFECTS.none                            && configuration.time != undefined && configuration.time != Constants.EFFECTS.none )                            {                                //On enregistre la configuration                                this.configurations[0] = configuration;                                //On ajoute une class afin de différencier les élements concernés des autres configurations.                                $(this.configurations[this.nbConfigurations].cvTitleEltClass).addClass(Constants.ELEMENTS.cltitle+this.nbConfigurations+Constants.GLOBAL.clend);                                $(this.configurations[this.nbConfigurations].cvMoreEltClass).addClass(Constants.ELEMENTS.clmore+this.nbConfigurations+Constants.GLOBAL.clend);                                $(this.configurations[this.nbConfigurations].cvInfosEltClass).addClass(Constants.ELEMENTS.clinfos+this.nbConfigurations+Constants.GLOBAL.clend);                                $(this.configurations[this.nbConfigurations].cvLessEltClass).addClass(Constants.ELEMENTS.clless+this.nbConfigurations+Constants.GLOBAL.clend);                                if (configuration.effect == Constants.EFFECTS.slide)                                    $("."+Constants.ELEMENTS.clinfos+this.nbConfigurations+Constants.GLOBAL.clend).slideUp(1);                                else if(configuration.effect == Constants.EFFECTS.fade)                                    $("."+Constants.ELEMENTS.clinfos+this.nbConfigurations+Constants.GLOBAL.clend).fadeOut(1);                                else if(configuration.effect == Constants.EFFECTS.toggle)                                    $("."+Constants.ELEMENTS.clinfos+this.nbConfigurations+Constants.GLOBAL.clend).toggle(1);                                else                                    alert("Mauvais paramétrage de l'effet pour la configuration "+this.nbConfigurations);                                $("."+Constants.ELEMENTS.clless+this.nbConfigurations+Constants.GLOBAL.clend).hide();                                this.nbConfigurations++;                            }                            else                                alert("Une des propriétes est mal initialisée ! \n"+configuration);                        }                    };                    /** Function addEffects()                     * Itere sur les configurations                     *  Pour chaque configuration                     *     ajoute une class aux élements cvInfosEltClass,cvLessEltClass,cvMoreEltClass,cvTitleEltClass                     *     ajoute une fonction onclick sur les elements :                     *          cvMoreEltClass et CvLessEltClass                     *                     *                     **/                    CvScript.prototype.addEffects = function() {                        for (i=0;i<this.nbConfigurations;i++)                        {                            if (this.configurations[i].effect == Constants.EFFECTS.slide) {                                //Ajout du onClick sur les élements "More"                                $('.'+Constants.ELEMENTS.clmore+i+Constants.GLOBAL.clend).each(function(index,element) {                                    $(element).addClass(Constants.GLOBAL.identifier+index+Constants.GLOBAL.identifier);                                    $(element).click(function() {                                        var numElt = getElementNumber(this);                                        var numConf = getConfigNumber(this);                                        $('.'+Constants.ELEMENTS.clinfos+getConfigNumber(this)+Constants.GLOBAL.clend+':eq('+numElt+')').slideDown(cvScript.configurations[numConf].time,function() {                                                 $('.'+Constants.ELEMENTS.clmore+numConf+Constants.GLOBAL.clend+':eq('+numElt+')').hide();                                                 $('.'+Constants.ELEMENTS.clless+numConf+Constants.GLOBAL.clend+':eq('+numElt+')').show();                                         });                                    });                                });                                //Ajout du onClick sur les élements "less"                                $('.'+Constants.ELEMENTS.clless+i+Constants.GLOBAL.clend).each(function(index,element) {                                    $(element).addClass(Constants.GLOBAL.identifier+index+Constants.GLOBAL.identifier);                                    $(element).click(function() {                                        var numElt = getElementNumber(this);                                        var numConf = getConfigNumber(this);                                        $('.'+Constants.ELEMENTS.clinfos+getConfigNumber(this)+Constants.GLOBAL.clend+':eq('+numElt+')').slideUp(cvScript.configurations[numConf].hiddingTime,function() {                                                 $('.'+Constants.ELEMENTS.clless+numConf+Constants.GLOBAL.clend+':eq('+numElt+')').hide();                                                 $('.'+Constants.ELEMENTS.clmore+numConf+Constants.GLOBAL.clend+':eq('+numElt+')').show();                                         });                                    });                                });                            }                             else if(this.configurations[i].effect == Constants.EFFECTS.fade) {                                 //Ajout du onClick sur les élements "More"                                $('.'+Constants.ELEMENTS.clmore+i+Constants.GLOBAL.clend).each(function(index,element) {                                    $(element).addClass(Constants.GLOBAL.identifier+index+Constants.GLOBAL.identifier);                                    $(element).click(function() {                                        var numElt = getElementNumber(this);                                        var numConf = getConfigNumber(this);                                        $('.'+Constants.ELEMENTS.clinfos+getConfigNumber(this)+Constants.GLOBAL.clend+':eq('+numElt+')').fadeIn(cvScript.configurations[numConf].time,function() {                                                 $('.'+Constants.ELEMENTS.clmore+numConf+Constants.GLOBAL.clend+':eq('+numElt+')').hide();                                                 $('.'+Constants.ELEMENTS.clless+numConf+Constants.GLOBAL.clend+':eq('+numElt+')').show();                                         });                                    });                                });                                //Ajout du onClick sur les élements "less"                                $('.'+Constants.ELEMENTS.clless+i+Constants.GLOBAL.clend).each(function(index,element) {                                    $(element).addClass(Constants.GLOBAL.identifier+index+Constants.GLOBAL.identifier);                                    $(element).click(function() {                                        var numElt = getElementNumber(this);                                        var numConf = getConfigNumber(this);                                        $('.'+Constants.ELEMENTS.clinfos+getConfigNumber(this)+Constants.GLOBAL.clend+':eq('+numElt+')').fadeOut(cvScript.configurations[numConf].hiddingTime,function() {                                                 $('.'+Constants.ELEMENTS.clless+numConf+Constants.GLOBAL.clend+':eq('+numElt+')').hide();                                                 $('.'+Constants.ELEMENTS.clmore+numConf+Constants.GLOBAL.clend+':eq('+numElt+')').show();                                         });                                    });                                });                             }                             else if(this.configurations[i].effect == Constants.EFFECTS.toggle) {                                  //Ajout du onClick sur les élements "More"                                $('.'+Constants.ELEMENTS.clmore+i+Constants.GLOBAL.clend).each(function(index,element) {                                    $(element).addClass(Constants.GLOBAL.identifier+index+Constants.GLOBAL.identifier);                                    $(element).click(function() {                                        var numElt = getElementNumber(this);                                        var numConf = getConfigNumber(this);                                        $('.'+Constants.ELEMENTS.clinfos+getConfigNumber(this)+Constants.GLOBAL.clend+':eq('+numElt+')').toggle(cvScript.configurations[numConf].time,function() {                                                 $('.'+Constants.ELEMENTS.clmore+numConf+Constants.GLOBAL.clend+':eq('+numElt+')').hide();                                                 $('.'+Constants.ELEMENTS.clless+numConf+Constants.GLOBAL.clend+':eq('+numElt+')').show();                                         });                                    });                                });                                //Ajout du onClick sur les élements "less"                                $('.'+Constants.ELEMENTS.clless+i+Constants.GLOBAL.clend).each(function(index,element) {                                    $(element).addClass(Constants.GLOBAL.identifier+index+Constants.GLOBAL.identifier);                                    $(element).click(function() {                                        var numElt = getElementNumber(this);                                        var numConf = getConfigNumber(this);                                        $('.'+Constants.ELEMENTS.clinfos+getConfigNumber(this)+Constants.GLOBAL.clend+':eq('+numElt+')').toggle(cvScript.configurations[numConf].hiddingTime,function() {                                                 $('.'+Constants.ELEMENTS.clless+numConf+Constants.GLOBAL.clend+':eq('+numElt+')').hide();                                                 $('.'+Constants.ELEMENTS.clmore+numConf+Constants.GLOBAL.clend+':eq('+numElt+')').show();                                         });                                    });                                });                             }                        }                    };                    CvScript.initialized = true;                }            }            var getConfigNumber = function(element){                var classNames = $(element).attr("class");                var start;                var isfind = classNames.indexOf(Constants.ELEMENTS.clmore);                if (isfind != -1)                    start = isfind+Constants.ELEMENTS.clmore.length;                else{                    start = classNames.indexOf(Constants.ELEMENTS.clless)+Constants.ELEMENTS.clless.length;                }                var end = classNames.indexOf(Constants.GLOBAL.clend,start);                return classNames.substring(                    start,                    end);            };            var getElementNumber = function(element){                var classNames = $(element).attr("class");                var start = classNames.indexOf(Constants.GLOBAL.identifier)+Constants.GLOBAL.identifier.length;                var end = classNames.indexOf(Constants.GLOBAL.identifier,start);                return classNames.substring(                    start,                    end);            };                        var cvScript = new CvScript();            /**AJOUT D'UNE CONFIGURATION**/            var config0 = new Configuration();            config0.cvTitleEltClass = ".cvwhat";            config0.cvMoreEltClass = ".cvMoreEltClass";            config0.cvLessEltClass = ".cvLessEltClass";            config0.cvInfosEltClass = ".cvInfosEltClass";            config0.effect = Constants.EFFECTS.fade;            config0.time = "2000";            cvScript.addConfiguration(config0);            /** FIN AJOUT D'UNE CONFIGURATION **/            cvScript.addEffects();});